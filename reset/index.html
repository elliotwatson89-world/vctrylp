<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>VCTRYLP. — RESET</title>

  <link rel="icon" href="../favicon.ico" />

  <style>
    /* =========================
       Font
       ========================= */
    @font-face{
      font-family: "Lab Mono";
      src: url("../LabMono.woff2") format("woff2");
      font-weight: 400;
      font-style: normal;
      font-display: swap;
    }

    /* =========================
       Variables
       ========================= */
    :root{
      /* Match your video “black” */
      --bg: rgb(30, 30, 30);

      --ink: rgba(244,244,244,.92);

      /* Prompt padding from the video frame */
      --edge-pad: 24px;

      /* Footer alignment to logo:
         distance UP from the bottom of the VIDEO frame */
      --footer-inset: calc(54px + env(safe-area-inset-bottom, 0px));

      /* Left padding from the video frame */
      --side-inset: 24px;

      /* Safe areas */
      --safe-left: env(safe-area-inset-left, 0px);
      --safe-top:  env(safe-area-inset-top, 0px);

      /* Video box defaults (overwritten by JS) */
      --video-left: 0px;
      --video-top: 0px;
      --video-width: 100vw;
      --video-height: 100vh;
    }

    html, body{
      width: 100%;
      height: 100%;
      margin: 0;
      overflow: hidden;
      background: var(--bg);
    }

    /* =========================
       Video (CONTAIN, no crop)
       ========================= */
    .splash-video{
      position: fixed;
      left: var(--video-left);
      top: var(--video-top);
      width: var(--video-width);
      height: var(--video-height);

      object-fit: fill;           /* element is already contain-sized by JS */
      background: var(--bg);
      display: block;

      z-index: 0;
    }

    /* =========================
       Overlay above video
       ========================= */
    .overlay{
      position: fixed;
      inset: 0;
      z-index: 3;
    }

    /* Footer labels aligned to the VIDEO frame (like your homepage) */
    .contact,
    .treatment{
      position: fixed;

      /* Anchor to bottom of the video frame, not viewport */
      bottom: calc((100vh - (var(--video-top) + var(--video-height))) + var(--footer-inset));

      font-family: "Lab Mono", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 12pt;
      letter-spacing: 0.06em;
      text-transform: uppercase;
      line-height: 1.2;
      color: var(--ink);

      opacity: 0;
      transition: opacity 900ms cubic-bezier(.2,.9,.2,1);
    }

    .contact{
      left: calc(var(--video-left) + var(--side-inset) + var(--safe-left));
      text-decoration: none;
    }

    .treatment{
      left: calc(var(--video-left) + (var(--video-width) / 2));
      transform: translateX(-50%);
    }

    .contact.is-visible,
    .treatment.is-visible{
      opacity: 1;
    }

    /* =========================
       Reset prompt
       ========================= */
    .resetPrompt{
      position: fixed;
      left: calc(var(--video-left) + var(--edge-pad) + var(--safe-left));
      top:  calc(var(--video-top) + var(--edge-pad) + var(--safe-top));
      z-index: 3;

      font-family: "Lab Mono", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 12pt;
      letter-spacing: 0.06em;
      text-transform: uppercase;
      line-height: 1.2;

      opacity: 0;
      transform: translateY(6px);
      transition: opacity 900ms cubic-bezier(.2,.9,.2,1),
                  transform 900ms cubic-bezier(.2,.9,.2,1);
    }

    .resetPrompt.is-visible{
      opacity: 1;
      transform: translateY(0);
    }

    .resetLine{
      display: inline-flex;
      align-items: baseline;
      gap: 10px;
    }

    .resetTyped{
      color: var(--ink);
    }

    .resetInputRow{
      margin-top: 18px;
      display: none;
      align-items: baseline;
      gap: 14px;
    }

    .resetInputRow.is-visible{
      display: inline-flex;
    }

    .resetArrow{
      color: rgba(244,244,244,.75);
    }

    .resetInput{
      font: inherit;
      color: var(--ink);
      background: transparent;
      border: none;
      outline: none;
      padding: 0;
      width: min(340px, 60vw);
      letter-spacing: 0.08em;
      text-transform: uppercase;
    }

    .resetError{
      margin-top: 12px;
      color: rgba(244,244,244,.85);
      opacity: 0;
      transform: translateY(6px);
      transition: opacity 400ms ease, transform 400ms ease;
    }

    .resetError.is-visible{
      opacity: 1;
      transform: translateY(0);
    }
  </style>
</head>

<body>
  <video
    id="splashVideo"
    class="splash-video"
    autoplay
    muted
    playsinline
    preload="auto"
  ></video>

  <div class="overlay">
    <a class="contact" id="contactLink" href="mailto:info@vctrylp.global">CONTACT</a>
    <div class="treatment" id="treatmentText">TREATMENT WRITER</div>

    <div class="resetPrompt" id="resetPrompt">
      <div class="resetLine">
        <span class="resetTyped" id="resetTyped"></span>
      </div>

      <div class="resetInputRow" id="resetInputRow">
        <span class="resetArrow">&gt;</span>
        <input
          id="pw"
          class="resetInput"
          type="password"
          autocomplete="current-password"
          aria-label="Password"
        />
      </div>

      <div class="resetError" id="resetErr">Incorrect password.</div>
    </div>
  </div>

  <script>
    // ===== SETTINGS =====
    const PASSWORD = "reset";
    const PHRASE = "ENTER PASSWORD";
    const TYPE_DELAY_MS = 55;
    const PLAYBACK_SPEED = 1.8;

    // Repo structure:
    // /reset/index.html  (this file)
    // /splash-horizontal.mp4 and /splash-vertical.mp4 at repo root
    const SRC_LANDSCAPE = "../splash-horizontal.mp4";
    const SRC_PORTRAIT  = "../splash-vertical.mp4";

    // ===== Elements =====
    const video = document.getElementById("splashVideo");
    const resetPrompt = document.getElementById("resetPrompt");
    const resetTyped = document.getElementById("resetTyped");
    const resetInputRow = document.getElementById("resetInputRow");
    const pw = document.getElementById("pw");
    const resetErr = document.getElementById("resetErr");
    const contact = document.getElementById("contactLink");
    const treatment = document.getElementById("treatmentText");

    let revealed = false;

    function pickSrc(){
      return (window.innerHeight > window.innerWidth) ? SRC_PORTRAIT : SRC_LANDSCAPE;
    }

    function loadVideo(){
      const src = pickSrc();
      if (video.getAttribute("data-src") === src) return;
      video.setAttribute("data-src", src);
      video.innerHTML = `<source src="${src}" type="video/mp4">`;
      video.load();
    }

    // Same contain-fit box logic you used on your homepage
    function setVideoBoxVars(){
      const vw = window.innerWidth;
      const vh = window.innerHeight;

      const videoW = video.videoWidth || 16;
      const videoH = video.videoHeight || 9;

      const videoAR = videoW / videoH;
      const viewAR = vw / vh;

      let width, height, left, top;

      if (viewAR > videoAR){
        height = vh;
        width = vh * videoAR;
        left = (vw - width) / 2;
        top = 0;
      } else {
        width = vw;
        height = vw / videoAR;
        left = 0;
        top = (vh - height) / 2;
      }

      const root = document.documentElement.style;
      root.setProperty("--video-left", `${left}px`);
      root.setProperty("--video-top", `${top}px`);
      root.setProperty("--video-width", `${width}px`);
      root.setProperty("--video-height", `${height}px`);
    }

    async function typeText(txt){
      resetTyped.textContent = "";
      for (let i = 1; i <= txt.length; i++){
        resetTyped.textContent = txt.slice(0, i);
        await new Promise(r => setTimeout(r, TYPE_DELAY_MS));
      }
    }

    function showError(){
      resetErr.classList.add("is-visible");
      pw.value = "";
      pw.focus();
      setTimeout(() => resetErr.classList.remove("is-visible"), 1200);
    }

    function revealUI(){
      if (revealed) return;
      revealed = true;

      contact.classList.add("is-visible");
      treatment.classList.add("is-visible");
      resetPrompt.classList.add("is-visible");

      typeText(PHRASE).then(() => {
        resetInputRow.classList.add("is-visible");
        pw.focus();
      });
    }

    function finishAndHold(){
      revealUI();
      try{
        video.pause();
        if (video.duration) video.currentTime = Math.max(0, video.duration - 0.05);
      } catch(e){}
    }

    pw.addEventListener("keydown", (e) => {
      if (e.key !== "Enter") return;
      if ((pw.value || "").trim() === PASSWORD){
        sessionStorage.setItem("vctrylp_reset_ok", "1");
        window.location.href = "./about.html";
      } else {
        showError();
      }
    });

    // Boot
    loadVideo();
    setVideoBoxVars(); // initial fallback

    video.addEventListener("loadedmetadata", () => {
      setVideoBoxVars();
      video.playbackRate = PLAYBACK_SPEED;
      const p = video.play();
      if (p && typeof p.catch === "function") p.catch(() => {});
    });

    // Pause near end and reveal UI
    video.addEventListener("timeupdate", () => {
      if (!video.duration) return;
      if (video.currentTime >= video.duration - 0.08) finishAndHold();
    });

    // Keep alignment on resize/orientation
    window.addEventListener("resize", () => {
      loadVideo();
      setVideoBoxVars();
    });
    window.addEventListener("orientationchange", () => {
      loadVideo();
      setVideoBoxVars();
    });

    // Safety fallback
    setTimeout(() => finishAndHold(), 10000);
  </script>
</body>
</html>
