<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>VCTRYLP.</title>

  <link rel="icon" href="/favicon.ico?v=11" />
  <link rel="stylesheet" href="/style.css" />
</head>

<body>

  <!-- DESKTOP VIDEO ONLY -->
  <video
    id="splashVideo"
    class="splash-video desktop-only"
    autoplay
    muted
    playsinline
    preload="auto"
  >
    <source src="/splash-horizontal.mp4" type="video/mp4" />
  </video>

  <!-- MOBILE: NO VIDEO -->
  <div class="mobileStage mobile-only">
    <div class="mobileNav">
      <a class="contact is-visible" href="mailto:info@vctrylp.global">CONTACT</a>
      <img class="mobileLogo" src="/logo-white.png" alt="VCTRYLP" />
      <div class="treatment is-visible">TREATMENT<br>WRITER</div>
    </div>
  </div>

  <!-- DESKTOP OVERLAY -->
  <div class="overlay desktop-only">
    <div class="bottomNav" id="bottomNav">
      <a class="contact" id="contactLink" href="mailto:info@vctrylp.global">CONTACT</a>
      <div class="logoSpacer" aria-hidden="true"></div>
      <div class="treatment" id="treatmentText">TREATMENT WRITER</div>
    </div>
  </div>

  <script>
    const video = document.getElementById("splashVideo");

    const VIDEO_LANDSCAPE = "/splash-horizontal.mp4";
    const VIDEO_PORTRAIT  = "/splash-vertical.mp4";

    const PLAYBACK_SPEED = 2;   // âœ… speed for BOTH
    const REVEAL_AT_MS = 8000;    // reveal text after animation length
    const HOLD_LAST = true;

    // ===== Logo anchor inside the visible video rectangle (fractions 0..1) =====
    // Landscape logo ends bottom-right (from your horizontal animation)
    const LOGO_X_LANDSCAPE = 0.875;
    const LOGO_Y_LANDSCAPE = 0.84;

    // Portrait logo ends centered-bottom (from your vertical animation)
    const LOGO_X_PORTRAIT  = 0.50;
    const LOGO_Y_PORTRAIT  = 0.90;

    const bottomNav = document.getElementById("bottomNav");
    const contact = document.getElementById("contactLink");
    const treatment = document.getElementById("treatmentText");

    function isDesktop(){ return window.matchMedia("(min-width: 769px)").matches; }
    function isPortrait(){ return window.innerHeight >= window.innerWidth; }

    function setLogoAnchorVars(){
      const x = isPortrait() ? LOGO_X_PORTRAIT : LOGO_X_LANDSCAPE;
      const y = isPortrait() ? LOGO_Y_PORTRAIT : LOGO_Y_LANDSCAPE;
      const s = document.documentElement.style;
      s.setProperty("--logo-x", x);
      s.setProperty("--logo-y", y);
    }

    // Compute visible (letterboxed) video rect so CSS positioning is correct
    function setVideoBoxVars(){
      const vw = window.innerWidth;
      const vh = window.innerHeight;

      const vW = video.videoWidth  || (isPortrait() ? 9 : 16);
      const vH = video.videoHeight || (isPortrait() ? 16 : 9);

      const videoAR = vW / vH;
      const viewAR = vw / vh;

      let width, height, left, top;

      if (viewAR > videoAR){
        height = vh;
        width = vh * videoAR;
        left = (vw - width) / 2;
        top = 0;
      } else {
        width = vw;
        height = vw / videoAR;
        left = 0;
        top = (vh - height) / 2;
      }

      const s = document.documentElement.style;
      s.setProperty("--video-left", `${left}px`);
      s.setProperty("--video-top", `${top}px`);
      s.setProperty("--video-width", `${width}px`);
      s.setProperty("--video-height", `${height}px`);
    }

    function reveal(){
      bottomNav.classList.add("is-visible");
      contact.classList.add("is-visible");
      treatment.classList.add("is-visible");
    }

    function holdLastFrame(){
      if (!HOLD_LAST) return;
      try{
        video.pause();
        if (video.duration) video.currentTime = Math.max(0, video.duration - 0.05);
      }catch(e){}
    }

    function setDesktopSource(){
      // Desktop always uses horizontal (as you requested)
      video.querySelector("source").src = VIDEO_LANDSCAPE;
      video.load();
    }

    if (isDesktop()){
      setLogoAnchorVars();
      setDesktopSource();

      video.addEventListener("loadedmetadata", () => {
        setVideoBoxVars();
        setLogoAnchorVars();

        video.playbackRate = PLAYBACK_SPEED;

        const p = video.play();
        if (p && typeof p.catch === "function") p.catch(()=>{});
      });

      // Reveal reliably at 8s regardless of whether ended fires
      setTimeout(() => {
        reveal();
        setTimeout(holdLastFrame, 200);
      }, REVEAL_AT_MS);

      video.addEventListener("ended", () => {
        reveal();
        holdLastFrame();
      });

      window.addEventListener("resize", () => {
        setLogoAnchorVars();
        setVideoBoxVars();
      });
    }
  </script>

</body>
</html>
