<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>VCTRYLP.</title>

  <link rel="icon" href="/favicon.ico?v=12" />
  <link rel="stylesheet" href="/style.css" />
</head>

<body>

  <!-- DESKTOP: VIDEO -->
  <video
    id="splashVideo"
    class="splash-video desktop-only"
    autoplay
    muted
    playsinline
    preload="auto"
  >
    <source src="/splash-horizontal.mp4" type="video/mp4" />
  </video>

  <!-- MOBILE: STATIC -->
  <div class="mobileStage mobile-only">
    <div class="mobileCaret"></div>

    <a class="mContact" href="mailto:info@vctrylp.global">CONTACT</a>
    <div class="mTreatment">TREATMENT WRITER</div>

    <img class="mLogo" src="/logo-white.png" alt="VCTRYLP" />
  </div>

  <!-- DESKTOP OVERLAY -->
  <div class="overlay desktop-only">
    <a class="contact" id="contactLink" href="mailto:info@vctrylp.global">CONTACT</a>
    <div class="treatment" id="treatmentText">TREATMENT WRITER</div>
    <div class="caret" id="caret"></div>
  </div>

  <script>
    const isDesktop = () =>
      window.matchMedia("(min-width: 769px)").matches;

    if (isDesktop()) {
      const video = document.getElementById("splashVideo");
      const contact = document.getElementById("contactLink");
      const treatment = document.getElementById("treatmentText");
      const caret = document.getElementById("caret");

      const PLAYBACK_SPEED = 1.7;
      const REVEAL_AT_MS = 8000;
      const HOLD_LAST = true;

      function setVideoBoxVars() {
        const vw = window.innerWidth;
        const vh = window.innerHeight;

        const vW = video.videoWidth || 16;
        const vH = video.videoHeight || 9;

        const videoAR = vW / vH;
        const viewAR = vw / vh;

        let width, height, left, top;

        // object-fit: contain math (visible video rect)
        if (viewAR > videoAR) {
          height = vh;
          width = vh * videoAR;
          left = (vw - width) / 2;
          top = 0;
        } else {
          width = vw;
          height = vw / videoAR;
          left = 0;
          top = (vh - height) / 2;
        }

        const s = document.documentElement.style;
        s.setProperty("--video-left", `${left}px`);
        s.setProperty("--video-top", `${top}px`);
        s.setProperty("--video-width", `${width}px`);
        s.setProperty("--video-height", `${height}px`);
      }

      function reveal() {
        contact.classList.add("is-visible");
        treatment.classList.add("is-visible");
        caret.classList.add("is-visible");
      }

      function holdLastFrame() {
        if (!HOLD_LAST) return;
        try {
          video.pause();
          if (video.duration) {
            video.currentTime = Math.max(0, video.duration - 0.05);
          }
        } catch (e) {}
      }

      video.addEventListener("loadedmetadata", () => {
        setVideoBoxVars();
        video.playbackRate = PLAYBACK_SPEED;

        const p = video.play();
        if (p && typeof p.catch === "function") p.catch(() => {});
      });

      window.addEventListener("resize", () => {
        setVideoBoxVars();
      });

      // Reveal after splash duration
      setTimeout(() => {
        reveal();
        setTimeout(holdLastFrame, 150);
      }, REVEAL_AT_MS);

      // Backup: if video ends naturally
      video.addEventListener("ended", () => {
        reveal();
        holdLastFrame();
      });

      // Safety: if video errors
      video.addEventListener("error", () => {
        reveal();
      });
    }
  </script>

</body>
</html>
